{% extends "spotter_base.html" %}

{% load price_tags %}

{% block main %}

<style type="text/css">

    ul, ol {
        margin: 0px 0px 0px 0px;
    }

    li {
        
        list-style-type: none !important;
    }


</style>


<header style="margin-bottom: 30px;">Usage digest {{ days }} days</header>

<h3>MRR ${{ MRR|stringformat:"1.2f"|cut:"-" }}</h3>
{% if login_users %}
<h3>Last login</h3>
<ul>
{% for login in login_users|dictsort:"last_login" %}
    <li> {{ login.email }} {{ login.last_login }}</li>
{% endfor %}
</ul>
{% endif %}
<br>

<div class="span3 digest">
    <h3>Clients:</h3>
    {% regroup clients by date_created as client_list %}
    {% for client in client_list %}
    <ul>{{ client.grouper }}</ul>
        <ul><ul>
        {% for c in client.list %}
        <li> {{ c.name }}</li>
        {% endfor %}
        </ul>
    {% endfor %}
    </ul>
</div>

<div class="span3 digest">
    <h3>Trainers:</h3>
    {% regroup trainers by date_created as trainer_list %}
    {% for trainer in trainer_list %}
    <ul>{{ trainer.grouper }}</ul>
        <ul><ul>
        {% for c in trainer.list %}
        <li> {{ c.name }}</li>
        {% endfor %}
        </ul>
    {% endfor %}
    </ul>
</div>

<div class="span3 digest">
    <h3>Members:</h3>
    {% regroup members by date_created as member_list %}
    {% for member in member_list %}
    <ul>{{ member.grouper }}</ul>
        <ul><ul>
        {% for c in member.list %}
        <li> {{ c.client.name }} in {{ c.blitz.name }} for $
        {% if c.blitz.price|member_price:c == 0 or c.blitz.price|member_price:c == None %}FREE{% else %}{{ c.blitz.price|member_price:c }}{% endif %} </li>
        {% endfor %}
        </ul>
    {% endfor %}
    </ul>
</div>

<h4>Usage digest past {{ days }} days</h4>

<h3>MRR ${{ MRR|stringformat:"1.2f"|cut:"-" }}</h3>

{% if trainers %}
<h3>New Trainers:</h3>
{% regroup trainers by date_created as trainer_list %}
{% for trainer in trainer_list %}
<ul><b>{{ trainer.grouper }}<b></ul>
    <ul><ul>
    {% for c in trainer.list %}
    <li> {{ c.name }}</li>
    {% endfor %}
    </ul>
{% endfor %}
</ul>
{% endif %}

{% if members %}
<h3>New Clients:</h3>
{% regroup members by date_created as member_list %}
{% for member in member_list %}
<ul><b>{{ member.grouper }}<b></ul>
    <ul><ul>
    {% for c in member.list %}
    <li> {{ c.client.name }} in {{ c.blitz.name }} (with {{ c.blitz.trainer.name }}) for ${{ c.blitz.price }}</li>
    {% endfor %}
    </ul>
{% endfor %}
</ul>
{% endif %}

{% if login_users %}
<h3>Last login</h3>
<ul>
{% for login in login_users|dictsort:"last_login" %}
    <li> {{ login.email }} {{ login.last_login }}</li>
{% endfor %}
</ul>
{% endif %}

{% endblock %}

