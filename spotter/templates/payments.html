{% extends "spotter_base.html" %}

{% block main %}

<header>Payment History</header>
<style>
      tr:nth-of-type(odd) {
      background-color:#D8F1D7;
    }
</style>

{% if test %}
(including test/free users)
{% else %}
(add <b>?test</b> to include test/free users)
{% endif %}

{% if charge %}
(processing payments due)
{% else %}
(add <b>?charge</b> to process charges)
{% endif %}

<div class="span6 offset3" style="margin-bottom: 50px; margin-top: 50px; padding-right: 20px;">

{% if clients %}
{% for client in clients|dictsortreversed:"due" %}
  <div style="border: 1px solid #fff; border-radius: 5px; padding: 20px; margin-bottom: 30px;">
     <div style="text-align: left;" class="spotterheader">
     <ul><li>{{ client.client.name }} <small>{{  client.client.balanced_account_uri }}</small> <br> start date: {{ client.start }} ({{ client.months }} months)</li>  {% if not client.blitz.recurring %} <li> Blitz:{{ client.blitz.title }} {% endif %}
     {% if client.membership.price %}Invited Price: ${{ client.membership.price|stringformat:"0.2f" }}
     {% else %} ${{ client.blitz.price|stringformat:"0.2f" }}{% endif %}</li>
<br>
     Cost: ${{ client.total_cost }} Paid: ${{ client.total_paid }} DUE: ${{ client.due }}
<br><br>
   {% if client.payments %}
   Charges:
   <small>
     {% for payment in client.payments|dictsort:"created_at" %}
         <li> ({{ payment.status }}) ${{ payment.amount }}</li>
         <li> {{ payment.created_at }} Transaction #:{{ payment.xtion }} </li>
   <br> {% endfor %}
   </small>
     </ul>
   {% endif %}
   </div>
  </div>
  {% endfor %}

{% else %}
   <b>No Payments to report at this time.</b>
{% endif %}
</div>


{% endblock %}

